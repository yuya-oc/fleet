machine:
  node:
    version: 6.1.0

dependencies:
  pre:
    - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
    - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list

    - sudo dpkg --add-architecture i386
    - sudo add-apt-repository ppa:ubuntu-wine/ppa -y

    - sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF
    - echo "deb http://download.mono-project.com/repo/debian wheezy main" | sudo tee /etc/apt/sources.list.d/mono-xamarin.list

    - echo "deb http://archive.canonical.com/ubuntu trusty partner" | sudo tee /etc/apt/sources.list.d/partner.list

    - sudo apt-get update
    - sudo apt-get install --no-install-recommends -y
      yarn wine1.8 mono-devel ca-certificates-mono adobe-flashplugin
    - unset DISPLAY && wineboot --init
  override:
    - yarn
compile:
  override:
    - yarn run build
    - yarn run pack
    - find dist -name "*.zip" -exec mv -v {} ${CIRCLE_ARTIFACTS}/ \;
    - mv dist/*.AppImage ${CIRCLE_ARTIFACTS}/
test:
  override:
    - yarn run lint:js
